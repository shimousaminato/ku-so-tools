<!DOCTYPE html>
<html>
<head>
  <link rel="apple-touch-icon" href="">
  <link rel="shortcut icon" href="">
  <title>空想ツール</title>
  <link rel="stylesheet" href="https://shimousaminato.github.io/ku-so-tools/index.css">
  <style>
    input{
      display: none;
    }
    input:checked::before{
      content:"✅";
    }
  </style>
</head>
<body>
  <form id="kusosearch" method="GET">
<label><input type="radio" name="dest" id="railway" value="https://ku-tetsu.net/list.html" checked>空想鉄道</label>
<label><input type="radio" name="dest" id="oldrailway" value="https://old.ku-tetsu.net/list.html">空想旧鉄</label>
<label><input type="radio" name="dest" id="road" value="https://road.chi-zu.net/list.html">空想道路</label>
<label><input type="radio" name="dest" id="any" value="https://any.chi-zu.net/list.html">空想地図</label>
<label><input type="radio" name="dest" id="chart" value="https://chart.chi-zu.net/list.html">空想路線図</label>
<label><input type="radio" name="dest" id="pict" value="https://pict.zu-ga.net/list.html">空想図画</label>
<label><input type="radio" name="dest" id="memo" value="https://memo.zu-ga.net/list.html">空想文章</label>
<label><input type="radio" name="dest" id="annex" value="https://annex.chi-zu.net/list.html">空想別館</label><br>
<label><input type="radio" name="dest" id="timetable" value="https://timetable.zu-ga.net/list.html">時刻表くらぶ</label>
<label><input type="radio" name="dest" id="point" value="https://point.zu-ga.net/list.html">点描くらぶ</label>
<label><input type="radio" name="dest" id="nigaoe" value="https://nigaoe.zu-ga.net/list.html">似顔絵くらぶ</label>
<label><input type="radio" name="dest" id="quiz" value="https://quiz.zu-ga.net/list.html">問題くらぶ</label><br>
<label><input type="radio" name="dest" id="doshusei" value="https://doshusei.chi-zu.net/list.html">道州制ふぁん</label>
<label><input type="radio" name="dest" id="osakato" value="https://osakato.chi-zu.net/list.html">大阪都ふぁん</label>
<label><input type="radio" name="dest" id="tokyoto" value="https://tokyoto.chi-zu.net/list.html">東京都ふぁん</label>
<label><input type="radio" name="dest" id="ritsuryo" value="https://ritsuryo.chi-zu.net/list.html">律令国ふぁん</label>
<label><input type="radio" name="dest" id="rokutairiku" value="https://rokutairiku.chi-zu.net/list.html">六大陸ふぁん</label>
<label><input type="radio" name="dest" id="nurie" value="https://nurie.zu-ga.net/list.html">地図ぬりえ</label><br>
<input type="search" name="f1" placeholder="作品名" size="10">
<input type="search" name="f2" placeholder="登録者名" size="10">
<input type="search" name="f3" placeholder="説明" size="10">
<input type="number" id="pag" name="p" placeholder="ページ数(数字)" size="10">
<select name="o" id="common">
<option value="">登録日(新)順</option>
<option value="regist_date_asc">登録日(古)順</option>
<option value="map_update_date_desc">更新日(新)順</option>
<option value="comment_date_desc">コメント日(新)順</option>
<option value="comment_date_asc">コメント日(古)順</option>
<option id="mn1" value="lnamt_desc">路線数順</option>
<option id="mn2" value="stamt_desc">駅数順</option>
<option id="mn3" value="dist_desc">距離順</option>
<option value="comment_count_desc">コメント数順</option>
<option value="access_count_desc">アクセス数順</option>
</select>
<input type="submit" value="作品検索">
</form><br>
 <script>
  const form = document.getElementById('kusosearch');
  const select = document.getElementById('common');
  const pageInput = document.getElementById('pag'); // 要素を取得

  form.addEventListener('submit', (e) => {
    const selectedRadio = document.querySelector('input[name="dest"]:checked');
    
    if (selectedRadio) {
      // 送信先を決定
      form.action = selectedRadio.value;

      // --- チェック1: 空想文章の制限 ---
      const site = selectedRadio.id;
      const selectedId = select.options[select.selectedIndex].id;
      if (site === "memo" && selectedId.startsWith("mn")) {
        e.preventDefault();
        alert("空想文章では文章量、文章数、距離の検索機能は廃止されました。");
        return;
      }

      // --- チェック2: ページ数の自然数チェック (追加箇所) ---
      // 値が "0" または 0以下 の場合
      if (pageInput.value !== "" && parseInt(pageInput.value) <= 0 ) {
        e.preventDefault();
        alert('ページ数には必ず自然数（1以上）を入力してください。');
        return;
      }

      // URLを綺麗にする
      selectedRadio.removeAttribute('name');
    }
  });

  window.addEventListener('pageshow', () => {
    const radios = document.querySelectorAll('input[type="radio"]');
    radios.forEach(r => r.setAttribute('name', 'dest'));
  });
</script>
</body>
</html>
